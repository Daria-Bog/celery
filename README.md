# AI Image Upscaling Service (Flask + Celery)

Сервис для увеличения разрешения изображений с использованием модели ИИ (EDSR x2) и фоновой обработки задач.

## Ключевые особенности
- **Оптимизация модели**: Модель загружается в память воркера единожды и переиспользуется для всех задач.
- **Работа In-Memory**: Изображения не сохраняются на диск сервера; передача и обработка происходят в виде байтовых потоков (BytesIO), что ускоряет работу и экономит ресурс диска.
- **Масштабируемость**: Благодаря Celery и Redis, обработка тяжелых ИИ-задач происходит в фоновом режиме, не блокируя основной API.
- **Контейнеризация**: Полная настройка через Docker Compose.

## Технологический стек
- Python 3.11, Flask
- Celery (Background Tasks)
- Redis (Message Broker & Result Backend)
- OpenCV (DNN модуль для работы с моделью EDSR)
- Pytest (Unit-тестирование)

## Инструкция по запуску

1. **Запуск всей системы**:
   ```bash
   docker-compose up --build
   ```
2. **Выполнение автоматических тестов (pytest)**:
    ```bash
   # Запустите в контейнере или локально при установленных зависимостях
   pytest tests/test_api.py
   ```
3. **Запуск интеграционного теста**: В отдельном терминале запустите клиентский скрипт, который отправит реальное изображение:
    ```bash
   python test_client.py
   ```
## API Эндпоинты
- POST /upscale — отправить изображение (поле image). Возвращает task_id.

- GET /tasks/<task_id> — получить статус обработки и ссылку на результат.

- GET /processed/<task_id> — скачать готовое изображение.

## Структура проекта
- app.py — сервер Flask и определение задач Celery.

- test_client.py — скрипт для имитации действий пользователя.

- tests/ — папка с Unit-тестами роутов.

- EDSR_x2.pb — предобученная модель ИИ.